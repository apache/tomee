<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<!-- $Rev: 600180 $ $Date: 2007-12-01 19:52:39 +0100 (Sat, 01 Dec 2007) $ -->

<ns3:openejb-jar xmlns="http://geronimo.apache.org/xml/ns/deployment-1.2" xmlns:ns2="http://geronimo.apache.org/xml/ns/naming-1.2" xmlns:ns3="http://openejb.apache.org/xml/ns/openejb-jar-2.2" xmlns:ns4="http://openejb.apache.org/xml/ns/pkgen-2.1" xmlns:ns5="http://geronimo.apache.org/xml/ns/j2ee/application-1.2" xmlns:ns6="http://geronimo.apache.org/xml/ns/security-2.0" xmlns:ns7="http://java.sun.com/xml/ns/persistence" xmlns:ns8="http://geronimo.apache.org/xml/ns/j2ee/ejb/openejb-2.0">
    <ns2:cmp-connection-factory>
        <ns2:resource-link>jdbc/TradeDataSource</ns2:resource-link>
    </ns2:cmp-connection-factory>
    <ns3:enterprise-beans>
        <ns3:session>
            <ns3:ejb-name>TradeEJB</ns3:ejb-name>
            <ns3:jndi-name>ejb/TradeEJB</ns3:jndi-name>
        </ns3:session>
        <ns3:session>
            <ns3:ejb-name>TradeJPA</ns3:ejb-name>
            <ns2:persistence-context-ref>
                <ns2:persistence-context-ref-name>jpa/daytrader</ns2:persistence-context-ref-name>
                <ns2:persistence-unit-name>daytrader</ns2:persistence-unit-name>
                <ns2:persistence-context-type>transaction-scoped</ns2:persistence-context-type>
            </ns2:persistence-context-ref>
        </ns3:session>
        <ns3:session>
            <ns3:ejb-name>KeySequenceEJB</ns3:ejb-name>
            <ns3:jndi-name>ejb/KeySequenceEJB</ns3:jndi-name>
            <ns3:cache-size>100</ns3:cache-size>
        </ns3:session>
        <ns3:entity>
            <ns3:ejb-name>HoldingEJB</ns3:ejb-name>
            <ns3:table-name>HOLDINGEJB</ns3:table-name>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>purchasePrice</ns3:cmp-field-name>
                <ns3:table-column>purchasePrice</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>holdingID</ns3:cmp-field-name>
                <ns3:table-column>holdingID</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>quantity</ns3:cmp-field-name>
                <ns3:table-column>quantity</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>purchaseDate</ns3:cmp-field-name>
                <ns3:table-column>purchaseDate</ns3:table-column>
            </ns3:cmp-field-mapping>
        </ns3:entity>
        <ns3:entity>
            <ns3:ejb-name>AccountProfileEJB</ns3:ejb-name>
            <ns3:table-name>AccountProfileEJB</ns3:table-name>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>address</ns3:cmp-field-name>
                <ns3:table-column>address</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>passwd</ns3:cmp-field-name>
                <ns3:table-column>passwd</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>userID</ns3:cmp-field-name>
                <ns3:table-column>userID</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>email</ns3:cmp-field-name>
                <ns3:table-column>email</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>creditCard</ns3:cmp-field-name>
                <ns3:table-column>creditCard</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>fullName</ns3:cmp-field-name>
                <ns3:table-column>fullName</ns3:table-column>
            </ns3:cmp-field-mapping>
        </ns3:entity>
        <ns3:entity>
            <ns3:ejb-name>QuoteEJB</ns3:ejb-name>
            <ns3:table-name>QuoteEJB</ns3:table-name>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>low</ns3:cmp-field-name>
                <ns3:table-column>low</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>open</ns3:cmp-field-name>
                <ns3:table-column>open1</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>volume</ns3:cmp-field-name>
                <ns3:table-column>volume</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>price</ns3:cmp-field-name>
                <ns3:table-column>price</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>high</ns3:cmp-field-name>
                <ns3:table-column>high</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>companyName</ns3:cmp-field-name>
                <ns3:table-column>companyName</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>symbol</ns3:cmp-field-name>
                <ns3:table-column>symbol</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>change</ns3:cmp-field-name>
                <ns3:table-column>change1</ns3:table-column>
            </ns3:cmp-field-mapping>
        </ns3:entity>
        <ns3:entity>
            <ns3:ejb-name>KeyGenEJB</ns3:ejb-name>
            <ns3:table-name>KeyGenEJB</ns3:table-name>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>keyVal</ns3:cmp-field-name>
                <ns3:table-column>keyVal</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>keyName</ns3:cmp-field-name>
                <ns3:table-column>keyName</ns3:table-column>
            </ns3:cmp-field-mapping>
        </ns3:entity>
        <ns3:entity>
            <ns3:ejb-name>AccountEJB</ns3:ejb-name>
            <ns3:table-name>AccountEJB</ns3:table-name>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>creationDate</ns3:cmp-field-name>
                <ns3:table-column>creationDate</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>openBalance</ns3:cmp-field-name>
                <ns3:table-column>openBalance</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>logoutCount</ns3:cmp-field-name>
                <ns3:table-column>logoutCount</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>balance</ns3:cmp-field-name>
                <ns3:table-column>balance</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>accountID</ns3:cmp-field-name>
                <ns3:table-column>accountID</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>lastLogin</ns3:cmp-field-name>
                <ns3:table-column>lastLogin</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>loginCount</ns3:cmp-field-name>
                <ns3:table-column>loginCount</ns3:table-column>
            </ns3:cmp-field-mapping>
        </ns3:entity>
        <ns3:entity>
            <ns3:ejb-name>OrderEJB</ns3:ejb-name>
            <ns3:table-name>OrderEJB</ns3:table-name>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>orderFee</ns3:cmp-field-name>
                <ns3:table-column>orderFee</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>completionDate</ns3:cmp-field-name>
                <ns3:table-column>completionDate</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>orderType</ns3:cmp-field-name>
                <ns3:table-column>orderType</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>orderStatus</ns3:cmp-field-name>
                <ns3:table-column>orderStatus</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>price</ns3:cmp-field-name>
                <ns3:table-column>price</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>quantity</ns3:cmp-field-name>
                <ns3:table-column>quantity</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>openDate</ns3:cmp-field-name>
                <ns3:table-column>openDate</ns3:table-column>
            </ns3:cmp-field-mapping>
            <ns3:cmp-field-mapping>
                <ns3:cmp-field-name>orderID</ns3:cmp-field-name>
                <ns3:table-column>orderID</ns3:table-column>
            </ns3:cmp-field-mapping>
        </ns3:entity>
        <ns3:message-driven>
            <ns3:ejb-name>TradeStreamerMDB</ns3:ejb-name>
            <ns2:resource-adapter>
                <ns2:resource-link>TradeJMSResources</ns2:resource-link>
            </ns2:resource-adapter>
            <ns3:activation-config>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>destinationType</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>javax.jms.Queue</ns3:activation-config-property-value>
                </ns3:activation-config-property>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>destination</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>TradeStreamerQueue</ns3:activation-config-property-value>
                </ns3:activation-config-property>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>acknowledgeMode</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>Auto-acknowledge</ns3:activation-config-property-value>
                </ns3:activation-config-property>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>SubscriptionDurability</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>NonDurable</ns3:activation-config-property-value>
                </ns3:activation-config-property>
            </ns3:activation-config>
        </ns3:message-driven>
        <ns3:message-driven>
            <ns3:ejb-name>TradeBrokerMDB</ns3:ejb-name>
            <ns2:resource-adapter>
                <ns2:resource-link>TradeJMSResources</ns2:resource-link>
            </ns2:resource-adapter>
            <ns3:activation-config>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>destinationType</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>javax.jms.Queue</ns3:activation-config-property-value>
                </ns3:activation-config-property>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>destination</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>TradeBrokerQueue</ns3:activation-config-property-value>
                </ns3:activation-config-property>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>acknowledgeMode</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>Auto-acknowledge</ns3:activation-config-property-value>
                </ns3:activation-config-property>
                <ns3:activation-config-property>
                    <ns3:activation-config-property-name>SubscriptionDurability</ns3:activation-config-property-name>
                    <ns3:activation-config-property-value>NonDurable</ns3:activation-config-property-value>
                </ns3:activation-config-property>
            </ns3:activation-config>
        </ns3:message-driven>
    </ns3:enterprise-beans>
    <ns3:relationships>
        <ns3:ejb-relation>
            <ns3:ejb-relation-name>Account-Orders</ns3:ejb-relation-name>
            <ns3:ejb-relationship-role>
                <ns3:ejb-relationship-role-name>AccountEJB</ns3:ejb-relationship-role-name>
                <ns3:relationship-role-source>
                    <ns3:ejb-name>AccountEJB</ns3:ejb-name>
                </ns3:relationship-role-source>
                <ns3:cmr-field>
                    <ns3:cmr-field-name>orders</ns3:cmr-field-name>
                </ns3:cmr-field>
                <ns3:role-mapping>
                    <ns3:cmr-field-mapping>
                        <ns3:key-column>accountID</ns3:key-column>
                        <ns3:foreign-key-column>account_accountID</ns3:foreign-key-column>
                    </ns3:cmr-field-mapping>
                </ns3:role-mapping>
            </ns3:ejb-relationship-role>
        </ns3:ejb-relation>
        <ns3:ejb-relation>
            <ns3:ejb-relation-name>Account-AccountProfile</ns3:ejb-relation-name>
            <ns3:ejb-relationship-role>
                <ns3:ejb-relationship-role-name>Account-Has-AccountProfile</ns3:ejb-relationship-role-name>
                <ns3:relationship-role-source>
                    <ns3:ejb-name>AccountEJB</ns3:ejb-name>
                </ns3:relationship-role-source>
                <ns3:cmr-field>
                    <ns3:cmr-field-name>profile</ns3:cmr-field-name>
                </ns3:cmr-field>
                <ns3:foreign-key-column-on-source/>
                <ns3:role-mapping>
                    <ns3:cmr-field-mapping>
                        <ns3:key-column>userID</ns3:key-column>
                        <ns3:foreign-key-column>profile_userID</ns3:foreign-key-column>
                    </ns3:cmr-field-mapping>
                </ns3:role-mapping>
            </ns3:ejb-relationship-role>
        </ns3:ejb-relation>
        <ns3:ejb-relation>
            <ns3:ejb-relation-name>Account-Holdings</ns3:ejb-relation-name>
            <ns3:ejb-relationship-role>
                <ns3:ejb-relationship-role-name>AccountEJB</ns3:ejb-relationship-role-name>
                <ns3:relationship-role-source>
                    <ns3:ejb-name>AccountEJB</ns3:ejb-name>
                </ns3:relationship-role-source>
                <ns3:cmr-field>
                    <ns3:cmr-field-name>holdings</ns3:cmr-field-name>
                </ns3:cmr-field>
                <ns3:role-mapping>
                    <ns3:cmr-field-mapping>
                        <ns3:key-column>accountID</ns3:key-column>
                        <ns3:foreign-key-column>account_accountID</ns3:foreign-key-column>
                    </ns3:cmr-field-mapping>
                </ns3:role-mapping>
            </ns3:ejb-relationship-role>
        </ns3:ejb-relation>
        <ns3:ejb-relation>
            <ns3:ejb-relation-name>Quote-Holdings</ns3:ejb-relation-name>
            <ns3:ejb-relationship-role>
                <ns3:ejb-relationship-role-name>Holding-Has-Quote</ns3:ejb-relationship-role-name>
                <ns3:relationship-role-source>
                    <ns3:ejb-name>HoldingEJB</ns3:ejb-name>
                </ns3:relationship-role-source>
                <ns3:cmr-field>
                    <ns3:cmr-field-name>quote</ns3:cmr-field-name>
                </ns3:cmr-field>
                <ns3:foreign-key-column-on-source/>
                <ns3:role-mapping>
                    <ns3:cmr-field-mapping>
                        <ns3:key-column>symbol</ns3:key-column>
                        <ns3:foreign-key-column>quote_symbol</ns3:foreign-key-column>
                    </ns3:cmr-field-mapping>
                </ns3:role-mapping>
            </ns3:ejb-relationship-role>
        </ns3:ejb-relation>
        <ns3:ejb-relation>
            <ns3:ejb-relation-name>Quote-Orders</ns3:ejb-relation-name>
            <ns3:ejb-relationship-role>
                <ns3:ejb-relationship-role-name>Order-Has-Quote</ns3:ejb-relationship-role-name>
                <ns3:relationship-role-source>
                    <ns3:ejb-name>OrderEJB</ns3:ejb-name>
                </ns3:relationship-role-source>
                <ns3:cmr-field>
                    <ns3:cmr-field-name>quote</ns3:cmr-field-name>
                </ns3:cmr-field>
                <ns3:foreign-key-column-on-source/>
                <ns3:role-mapping>
                    <ns3:cmr-field-mapping>
                        <ns3:key-column>symbol</ns3:key-column>
                        <ns3:foreign-key-column>quote_symbol</ns3:foreign-key-column>
                    </ns3:cmr-field-mapping>
                </ns3:role-mapping>
            </ns3:ejb-relationship-role>
        </ns3:ejb-relation>
        <ns3:ejb-relation>
            <ns3:ejb-relation-name>Order-Holding</ns3:ejb-relation-name>
            <ns3:ejb-relationship-role>
                <ns3:ejb-relationship-role-name>Order-Has-Holding</ns3:ejb-relationship-role-name>
                <ns3:relationship-role-source>
                    <ns3:ejb-name>OrderEJB</ns3:ejb-name>
                </ns3:relationship-role-source>
                <ns3:cmr-field>
                    <ns3:cmr-field-name>holding</ns3:cmr-field-name>
                </ns3:cmr-field>
                <ns3:foreign-key-column-on-source/>
                <ns3:role-mapping>
                    <ns3:cmr-field-mapping>
                        <ns3:key-column>holdingID</ns3:key-column>
                        <ns3:foreign-key-column>holding_holdingID</ns3:foreign-key-column>
                    </ns3:cmr-field-mapping>
                </ns3:role-mapping>
            </ns3:ejb-relationship-role>
        </ns3:ejb-relation>
    </ns3:relationships>
    <ns7:persistence version="1.0">
        <ns7:persistence-unit transaction-type="JTA" name="daytrader">
            <ns7:provider>org.apache.openjpa.persistence.PersistenceProviderImpl</ns7:provider>
            <ns7:jta-data-source>?name=jdbc/TradeDataSource</ns7:jta-data-source>
            <ns7:non-jta-data-source>?name=jdbc/NoTxTradeDataSource</ns7:non-jta-data-source>
            <ns7:class>org.apache.geronimo.samples.daytrader.AccountDataBean</ns7:class>
            <ns7:class>org.apache.geronimo.samples.daytrader.AccountProfileDataBean</ns7:class>
            <ns7:class>org.apache.geronimo.samples.daytrader.HoldingDataBean</ns7:class>
            <ns7:class>org.apache.geronimo.samples.daytrader.OrderDataBean</ns7:class>
            <ns7:class>org.apache.geronimo.samples.daytrader.QuoteDataBean</ns7:class>
            <ns7:exclude-unlisted-classes>false</ns7:exclude-unlisted-classes>
            <ns7:properties>
                <ns7:property value="org.apache.openjpa.jdbc.sql.DerbyDictionary" name="openjpa.jdbc.DBDictionary"/>
                <ns7:property value="table(Table=OPENJPASEQ, Increment=100)" name="openjpa.Sequence"/>
            </ns7:properties>
        </ns7:persistence-unit>
    </ns7:persistence>
</ns3:openejb-jar>
