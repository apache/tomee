<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

<!-- $Rev$ $Date$ -->

<openejb-jar xmlns="http://www.openejb.org/xml/ns/openejb-jar-2.1">
  <cmp-connection-factory>
    <resource-link>jdbc/TradeDataSource</resource-link>
  </cmp-connection-factory>
  <enterprise-beans>
    <session>
      <ejb-name>TradeEJB</ejb-name>
      <jndi-name>ejb/TradeEJB</jndi-name>
    </session>
    <session>
      <ejb-name>TradeJPA</ejb-name>
      <persistence-context-ref>
        <persistence-context-ref-name>jpa/daytrader</persistence-context-ref-name>
        <persistence-unit-name>daytrader</persistence-unit-name>
        <persistence-context-type>transaction-scoped</persistence-context-type>
      </persistence-context-ref>
    </session>
    <session>
      <ejb-name>KeySequenceEJB</ejb-name>
      <jndi-name>ejb/KeySequenceEJB</jndi-name>
      <cache-size>100</cache-size>
    </session>
    <entity>
      <ejb-name>HoldingEJB</ejb-name>
      <table-name>HOLDINGEJB</table-name>
      <cmp-field-mapping>
        <cmp-field-name>purchasePrice</cmp-field-name>
        <table-column>purchasePrice</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>holdingID</cmp-field-name>
        <table-column>holdingID</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>quantity</cmp-field-name>
        <table-column>quantity</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>purchaseDate</cmp-field-name>
        <table-column>purchaseDate</table-column>
      </cmp-field-mapping>
    </entity>
    <entity>
      <ejb-name>AccountProfileEJB</ejb-name>
      <table-name>AccountProfileEJB</table-name>
      <cmp-field-mapping>
        <cmp-field-name>address</cmp-field-name>
        <table-column>address</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>passwd</cmp-field-name>
        <table-column>passwd</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>userID</cmp-field-name>
        <table-column>userID</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>email</cmp-field-name>
        <table-column>email</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>creditCard</cmp-field-name>
        <table-column>creditCard</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>fullName</cmp-field-name>
        <table-column>fullName</table-column>
      </cmp-field-mapping>
    </entity>
    <entity>
      <ejb-name>QuoteEJB</ejb-name>
      <table-name>QuoteEJB</table-name>
      <cmp-field-mapping>
        <cmp-field-name>low</cmp-field-name>
        <table-column>low</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>open</cmp-field-name>
        <table-column>open1</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>volume</cmp-field-name>
        <table-column>volume</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>price</cmp-field-name>
        <table-column>price</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>high</cmp-field-name>
        <table-column>high</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>companyName</cmp-field-name>
        <table-column>companyName</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>symbol</cmp-field-name>
        <table-column>symbol</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>change</cmp-field-name>
        <table-column>change1</table-column>
      </cmp-field-mapping>
    </entity>
    <entity>
      <ejb-name>KeyGenEJB</ejb-name>
      <table-name>KeyGenEJB</table-name>
      <cmp-field-mapping>
        <cmp-field-name>keyVal</cmp-field-name>
        <table-column>keyVal</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>keyName</cmp-field-name>
        <table-column>keyName</table-column>
      </cmp-field-mapping>
    </entity>
    <entity>
      <ejb-name>AccountEJB</ejb-name>
      <table-name>AccountEJB</table-name>
      <cmp-field-mapping>
        <cmp-field-name>creationDate</cmp-field-name>
        <table-column>creationDate</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>openBalance</cmp-field-name>
        <table-column>openBalance</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>logoutCount</cmp-field-name>
        <table-column>logoutCount</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>balance</cmp-field-name>
        <table-column>balance</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>accountID</cmp-field-name>
        <table-column>accountID</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>lastLogin</cmp-field-name>
        <table-column>lastLogin</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>loginCount</cmp-field-name>
        <table-column>loginCount</table-column>
      </cmp-field-mapping>
    </entity>
    <entity>
      <ejb-name>OrderEJB</ejb-name>
      <table-name>OrderEJB</table-name>
      <cmp-field-mapping>
        <cmp-field-name>orderFee</cmp-field-name>
        <table-column>orderFee</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>completionDate</cmp-field-name>
        <table-column>completionDate</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>orderType</cmp-field-name>
        <table-column>orderType</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>orderStatus</cmp-field-name>
        <table-column>orderStatus</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>price</cmp-field-name>
        <table-column>price</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>quantity</cmp-field-name>
        <table-column>quantity</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>openDate</cmp-field-name>
        <table-column>openDate</table-column>
      </cmp-field-mapping>
      <cmp-field-mapping>
        <cmp-field-name>orderID</cmp-field-name>
        <table-column>orderID</table-column>
      </cmp-field-mapping>
    </entity>
    <message-driven>
      <ejb-name>TradeStreamerMDB</ejb-name>
      <resource-adapter>
        <resource-link>TradeJMSResources</resource-link>
      </resource-adapter>
      <activation-config>
        <activation-config-property>
          <activation-config-property-name>destinationType</activation-config-property-name>
          <activation-config-property-value>javax.jms.Queue</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>destination</activation-config-property-name>
          <activation-config-property-value>TradeStreamerQueue</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>acknowledgeMode</activation-config-property-name>
          <activation-config-property-value>Auto-acknowledge</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>SubscriptionDurability</activation-config-property-name>
          <activation-config-property-value>NonDurable</activation-config-property-value>
        </activation-config-property>
      </activation-config>
    </message-driven>
    <message-driven>
      <ejb-name>TradeBrokerMDB</ejb-name>
      <resource-adapter>
        <resource-link>TradeJMSResources</resource-link>
      </resource-adapter>
      <activation-config>
        <activation-config-property>
          <activation-config-property-name>destinationType</activation-config-property-name>
          <activation-config-property-value>javax.jms.Queue</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>destination</activation-config-property-name>
          <activation-config-property-value>TradeBrokerQueue</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>acknowledgeMode</activation-config-property-name>
          <activation-config-property-value>Auto-acknowledge</activation-config-property-value>
        </activation-config-property>
        <activation-config-property>
          <activation-config-property-name>SubscriptionDurability</activation-config-property-name>
          <activation-config-property-value>NonDurable</activation-config-property-value>
        </activation-config-property>
      </activation-config>
    </message-driven>
  </enterprise-beans>
  <relationships>
    <ejb-relation>
      <ejb-relation-name>Account-Orders</ejb-relation-name>
      <ejb-relationship-role>
        <ejb-relationship-role-name>AccountEJB</ejb-relationship-role-name>
        <relationship-role-source>
          <ejb-name>AccountEJB</ejb-name>
        </relationship-role-source>
        <cmr-field>
          <cmr-field-name>orders</cmr-field-name>
        </cmr-field>
        <role-mapping>
          <cmr-field-mapping>
            <key-column>accountID</key-column>
            <foreign-key-column>account_accountID</foreign-key-column>
          </cmr-field-mapping>
        </role-mapping>
      </ejb-relationship-role>
    </ejb-relation>
    <ejb-relation>
      <ejb-relation-name>Account-AccountProfile</ejb-relation-name>
      <ejb-relationship-role>
        <ejb-relationship-role-name>Account-Has-AccountProfile</ejb-relationship-role-name>
        <relationship-role-source>
          <ejb-name>AccountEJB</ejb-name>
        </relationship-role-source>
        <cmr-field>
          <cmr-field-name>profile</cmr-field-name>
        </cmr-field>
        <foreign-key-column-on-source/>
        <role-mapping>
          <cmr-field-mapping>
            <key-column>userID</key-column>
            <foreign-key-column>profile_userID</foreign-key-column>
          </cmr-field-mapping>
        </role-mapping>
      </ejb-relationship-role>
    </ejb-relation>
    <ejb-relation>
      <ejb-relation-name>Account-Holdings</ejb-relation-name>
      <ejb-relationship-role>
        <ejb-relationship-role-name>AccountEJB</ejb-relationship-role-name>
        <relationship-role-source>
          <ejb-name>AccountEJB</ejb-name>
        </relationship-role-source>
        <cmr-field>
          <cmr-field-name>holdings</cmr-field-name>
        </cmr-field>
        <role-mapping>
          <cmr-field-mapping>
            <key-column>accountID</key-column>
            <foreign-key-column>account_accountID</foreign-key-column>
          </cmr-field-mapping>
        </role-mapping>
      </ejb-relationship-role>
    </ejb-relation>
    <ejb-relation>
      <ejb-relation-name>Quote-Holdings</ejb-relation-name>
      <ejb-relationship-role>
        <ejb-relationship-role-name>Holding-Has-Quote</ejb-relationship-role-name>
        <relationship-role-source>
          <ejb-name>HoldingEJB</ejb-name>
        </relationship-role-source>
        <cmr-field>
          <cmr-field-name>quote</cmr-field-name>
        </cmr-field>
        <foreign-key-column-on-source/>
        <role-mapping>
          <cmr-field-mapping>
            <key-column>symbol</key-column>
            <foreign-key-column>quote_symbol</foreign-key-column>
          </cmr-field-mapping>
        </role-mapping>
      </ejb-relationship-role>
    </ejb-relation>
    <ejb-relation>
      <ejb-relation-name>Quote-Orders</ejb-relation-name>
      <ejb-relationship-role>
        <ejb-relationship-role-name>Order-Has-Quote</ejb-relationship-role-name>
        <relationship-role-source>
          <ejb-name>OrderEJB</ejb-name>
        </relationship-role-source>
        <cmr-field>
          <cmr-field-name>quote</cmr-field-name>
        </cmr-field>
        <foreign-key-column-on-source/>
        <role-mapping>
          <cmr-field-mapping>
            <key-column>symbol</key-column>
            <foreign-key-column>quote_symbol</foreign-key-column>
          </cmr-field-mapping>
        </role-mapping>
      </ejb-relationship-role>
    </ejb-relation>
    <ejb-relation>
      <ejb-relation-name>Order-Holding</ejb-relation-name>
      <ejb-relationship-role>
        <ejb-relationship-role-name>Order-Has-Holding</ejb-relationship-role-name>
        <relationship-role-source>
          <ejb-name>OrderEJB</ejb-name>
        </relationship-role-source>
        <cmr-field>
          <cmr-field-name>holding</cmr-field-name>
        </cmr-field>
        <foreign-key-column-on-source/>
        <role-mapping>
          <cmr-field-mapping>
            <key-column>holdingID</key-column>
            <foreign-key-column>holding_holdingID</foreign-key-column>
          </cmr-field-mapping>
        </role-mapping>
      </ejb-relationship-role>
    </ejb-relation>
  </relationships>
  <persistence xmlns="http://java.sun.com/xml/ns/persistence" version="1.0">
    <persistence-unit transaction-type="JTA" name="daytrader">
      <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
      <jta-data-source>?name=jdbc/TradeDataSource</jta-data-source>
      <non-jta-data-source>?name=jdbc/NoTxTradeDataSource</non-jta-data-source>
      <class>org.apache.geronimo.samples.daytrader.AccountDataBean</class>
      <class>org.apache.geronimo.samples.daytrader.AccountProfileDataBean</class>
      <class>org.apache.geronimo.samples.daytrader.HoldingDataBean</class>
      <class>org.apache.geronimo.samples.daytrader.OrderDataBean</class>
      <class>org.apache.geronimo.samples.daytrader.QuoteDataBean</class>
      <exclude-unlisted-classes/>
      <properties>
        <property name="openjpa.jdbc.DBDictionary" value="org.apache.openjpa.jdbc.sql.DerbyDictionary"/>
        <property name="openjpa.Sequence" value="table(Table=OPENJPASEQ, Increment=100)"/>
      </properties>
    </persistence-unit>
  </persistence>
</openejb-jar>
